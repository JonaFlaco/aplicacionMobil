events {
    worker_connections 1024;
}
http {
   server {
       listen 80;
       server_name localhost;

       # Archivos estáticos
       location /static/ {
           proxy_pass http://app:5000/static/;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           expires 30d;
       }
       
       # API endpoints
       location /api/ {
           proxy_pass http://app:5000/api/;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
           
           # Configuración para archivos grandes
           client_max_body_size 100M;
           proxy_read_timeout 300s;
           proxy_connect_timeout 300s;
           proxy_send_timeout 300s;
       }
       
       # Archivos de video subidos
       location /uploads/ {
           proxy_pass http://app:5000/uploads/;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
       }
       
       # Todo lo demás va al backend
       location / {
           proxy_pass http://app:5000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
   }
}